import { useState } from 'react';
import "./GuessArea.css";
import end from "../assets/end.jpg";
import kartagame from "../assets/KartaGame.jpg";

export default function GuessArea() {
  const areas = [
    { name: "Северняшка", full: "Северняшка област", class: "sev" },
    { name: "Тракийска", full: "Тракийска област", class: "trak" },
    { name: "Добруджанска", full: "Добруджанска област", class: "dobr" },
    { name: "Пиринска", full: "Пиринска област", class: "pirin" },
    { name: "Родопска", full: "Родопска област", class: "rod" },
    { name: "Шопска", full: "Шопска област", class: "shop" },
  ];

  const [target, setTarget] = useState(areas[Math.floor(Math.random() * areas.length)]);
  const [message, setMessage] = useState("Опитай да познаеш фолклорната област!");
  const [rounds, setRounds] = useState(0);
  const [correct, setCorrect] = useState(0);
  const [wrong, setWrong] = useState(0);
  const [gameOver, setGameOver] = useState(false);

  function pickArea(areaFull) {
    if (gameOver) return;

    if (areaFull.trim().toLowerCase() === target.full.trim().toLowerCase()) {
      setCorrect(c => c + 1);
      setMessage(`Поздравления! Позна ${target.full}!`);
    } else {
      setWrong(w => w + 1);
      setMessage(`Грешно! Това не е ${target.full}.`);
    }

    setRounds(r => {
      const newRounds = r + 1;
      if (newRounds >= 10) setGameOver(true);

      if (newRounds < 10) {
        setTarget(areas[Math.floor(Math.random() * areas.length)]);
      }
      return newRounds;
    });
  }

  function restartGame() {
    setRounds(0);
    setCorrect(0);
    setWrong(0);
    setGameOver(false);
    setMessage("Опитай да познаеш фолклорната област!");
    setTarget(areas[Math.floor(Math.random() * areas.length)]);
  }

  return (
    <div className="guess-container">
      <h1 className="guess-title">Познай фолклорната област</h1>

      {!gameOver ? (
        <p className="task">Натисни върху: <b>{target.full}</b></p>
      ) : (
        <p className="task"><b>Край на играта!</b></p>
      )}

      <div className="map-and-scoreboard-container">
        <div className="map-wrapper">
          <img src={kartagame} className="map" alt="Карта на България" />

        <svg viewBox='0 0 1080 756' className="svg-map">
            <polygon
            points='122,293,164,313,198,338,254,383,292,411,300,432,299,458,293,482,276,497,238,515,209,527,183,532,163,532,150,535,137,541,123,547,111,558,84,556,64,529,55,511,53,496,65,483,67,468,56,450,53,429,53,421,53,403,53,380,67,371,81,372,87,355,95,336,111,322,120,308'
            onClick={() => pickArea("Шопска област")}
            />

            <polygon
            points='295,412,300,435,300,467,281,503,309,510,369,548,406,558,450,553,482,549,553,577,581,582,627,605,656,611,682,611,710,605,741,604,726,577,736,568,748,568,761,560,760,544,789,541,801,529,801,513,811,497,846,499,854,480,866,471,879,464,916,468,944,490,965,475,999,471,1016,458,1021,441,1003,435,981,420,975,394,955,385,951,371,933,378,906,365,920,360,923,350,935,348,935,340,946,337,948,322,962,315,947,305,925,293,895,288,854,283,818,283,769,290,740,297,714,310,688,320,666,329,630,345,590,355,546,367,502,373,472,377,440,384,401,390,361,396'
            onClick={() => pickArea("Тракийска област")}
            />

            <polygon
            points='65,64,65,79,60,94,52,104,37,118,29,144,29,173,46,199,51,232,75,238,85,242,91,260,101,274,116,285,124,288,136,293,159,308,196,337,222,354,247,379,275,399,294,412,328,404,371,396,410,387,543,367,621,347,681,321,769,286,795,282,827,283,864,282,907,290,958,310,965,316,961,225,952,212,967,199,964,190,927,197,892,202,848,201,807,196,774,182,738,163,709,135,676,109,650,96,636,106,612,127,595,152,558,166,524,169,500,163,474,146,427,152,393,145,353,148,319,157,291,146,260,144,237,144,209,137,182,138,149,151,118,153,109,143,95,129,104,114,117,102,124,94,123,86,117,86,100,81,82,71'
            onClick={() => pickArea("Северняшка област")}
            />

            <polygon
            points='276,503,249,508,222,522,202,529,177,535,149,538,127,546,112,564,119,589,126,607,138,619,141,633,138,651,137,671,140,701,140,731,142,740,160,742,178,741,189,725,193,719,201,721,214,719,242,715,264,707,290,698,300,689,311,691,322,692,335,681,341,669,356,662,346,652,337,645,327,633,308,608,300,582,285,537'
            onClick={() => pickArea("Пиринска област")}
            />

            <polygon
            points='277,502,282,535,296,567,308,604,321,625,335,642,354,664,371,664,377,671,391,662,407,658,419,657,425,661,428,673,433,679,446,679,459,684,471,694,484,687,514,687,533,690,560,710,576,714,596,712,617,693,651,690,658,681,674,680,699,678,721,668,735,653,740,603,718,606,694,610,669,612,640,608,620,601,583,582,563,577,533,568,509,558,488,548,449,554,421,556,397,558,377,549,348,535,321,517,301,507'
            onClick={() => pickArea("Родопска област")}
            />

            <polygon
            points='652,93,687,65,725,59,749,48,784,42,815,35,823,48,847,55,863,58,876,50,888,56,907,53,917,51,926,68,942,81,962,90,987,92,1013,87,1030,84,1027,102,1039,115,1044,123,1030,134,1028,156,1015,148,999,153,992,168,975,166,970,185,952,189,922,196,898,196,868,198,822,198,779,185,746,167,718,139,689,117'
            onClick={() => pickArea("Добруджанска област")}
            />
        </svg>
      </div>
        <div className="scoreboard">
          <p className="message">{message}</p>
          <p>Рундове: {rounds} / 10</p>
          <p>Правилни: {correct}</p>
          <p>Грешни: {wrong}</p>
          {gameOver && (
            <button className="restart-button" onClick={restartGame}>Рестартирай играта</button>

            )}
        </div>
      </div>
      <div>
        <img src={end} alt="kartina" className='end-img'/>
      </div>
    </div>

  );
} 

